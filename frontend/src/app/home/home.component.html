<div class="home-container">
  <div class="welcome-section">
    <h1>Welcome to CampusLibra!</h1>
    <p>Hello, {{ currentUser?.name }}!</p>
    <p class="role-badge">{{ userRole | titlecase }}</p>
  </div>

  <!-- Search & Filter Section -->
  <div class="search-section mat-elevation-z1">
    <h2>Find Your Next Read</h2>

    <!-- Search Input -->
    <mat-form-field appearance="outline" class="search-input">
      <mat-label>Search books by title</mat-label>
      <input
        matInput
        [value]="searchQuery"
        (input)="searchQuery = $any($event.target).value; onSearchChange()"
        placeholder="Enter book title..."
      />
      <button
        matSuffix
        mat-icon-button
        *ngIf="searchQuery"
        (click)="searchQuery = ''; onSearchChange()"
      >
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>

    <!-- Category Filters -->
    <div class="category-filters">
      <span class="filter-label">Categories:</span>
      <div class="category-chips">
        <mat-chip-listbox>
          <mat-chip-option
            *ngFor="let category of categories"
            [selected]="selectedCategory === category"
            (selectionChange)="onCategorySelect(category)"
            color="primary"
          >
            {{ category }}
          </mat-chip-option>
        </mat-chip-listbox>
      </div>
    </div>

    <!-- Active Filters -->
    <div *ngIf="searchQuery || selectedCategory" class="active-filters">
      <span *ngIf="searchQuery" class="filter-tag">
        Title: "{{ searchQuery }}"
        <mat-icon (click)="searchQuery = ''; onSearchChange()">close</mat-icon>
      </span>
      <span *ngIf="selectedCategory" class="filter-tag">
        Category: {{ selectedCategory }}
        <mat-icon (click)="selectedCategory = ''; onSearchChange()"
          >close</mat-icon
        >
      </span>
      <button mat-button (click)="clearFilters()" color="warn">
        Clear All
      </button>
    </div>
  </div>

  <!-- Featured Books Section -->
  <div class="featured-books">
    <div *ngIf="loadingBooks" class="loading">Loading books...</div>

    <div *ngIf="error" class="error">
      {{ error }}
    </div>

    <div *ngIf="!loadingBooks && !error" class="books-grid">
      <app-book-card
        *ngFor="let book of featuredBooks"
        [book]="book"
        [showActions]="true"
      >
      </app-book-card>

      <div *ngIf="featuredBooks.length === 0" class="no-books">
        No books found matching your criteria.
      </div>
    </div>

    <div class="browse-all">
      <button mat-stroked-button routerLink="/books">Browse All Books â†’</button>
    </div>
  </div>

  <div class="quick-actions">
    <h2>Quick Actions</h2>

    <!-- Member Actions -->
    <div *ngIf="userRole === 'member'" class="action-grid">
      <button mat-raised-button color="primary" routerLink="/books">
        Browse Books
      </button>
      <button mat-raised-button color="accent" routerLink="/member/my-borrows">
        My Borrows
      </button>
      <button mat-raised-button routerLink="/member/my-reservations">
        My Reservations
      </button>
      <button mat-raised-button routerLink="/member/my-fines">My Fines</button>
    </div>

    <!-- Librarian Actions -->
    <div *ngIf="userRole === 'librarian'" class="action-grid">
      <button
        mat-raised-button
        color="primary"
        routerLink="/librarian/process-returns"
      >
        Process Returns
      </button>
      <button
        mat-raised-button
        color="accent"
        routerLink="/librarian/pending-pickups"
      >
        Pending Pickups
      </button>
      <button mat-raised-button routerLink="/librarian/member-management">
        Member Management
      </button>
      <button mat-raised-button routerLink="/books">Book Inventory</button>
    </div>

    <!-- Admin Actions -->
    <div *ngIf="userRole === 'admin'" class="action-grid">
      <button
        mat-raised-button
        color="primary"
        routerLink="/admin/books-manage"
      >
        Manage Books
      </button>
      <button mat-raised-button color="accent" routerLink="/admin/users-manage">
        Manage Users
      </button>
      <button mat-raised-button routerLink="/admin/system-settings">
        System Settings
      </button>
      <button mat-raised-button routerLink="/admin/audit-trail">
        Audit Trail
      </button>
    </div>
  </div>
</div>
