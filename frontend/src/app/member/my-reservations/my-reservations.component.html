<div class="reservations-container">
  <div class="header">
    <h1>My Reservations</h1>
    <p>
      You have {{ reservations.length }} active
      {{ reservations.length === 1 ? "reservation" : "reservations" }}
    </p>
  </div>

  <div *ngIf="loading" class="loading">
    <mat-spinner></mat-spinner>
    <p>Loading your reservations...</p>
  </div>

  <div *ngIf="error" class="error">
    <mat-icon>error</mat-icon>
    <p>{{ error }}</p>
    <button mat-button (click)="loadMyReservations()">Retry</button>
  </div>

  <div *ngIf="!loading && !error" class="reservations-list">
    <div *ngIf="reservations.length === 0" class="no-reservations">
      <mat-icon>event_seat</mat-icon>
      <h3>No Active Reservations</h3>
      <p>You haven't reserved any books yet.</p>
      <button mat-raised-button color="primary" routerLink="/books">
        Browse Books
      </button>
    </div>

    <div
      class="reservation-card mat-elevation-z2"
      *ngFor="let reservation of reservations"
    >
      <div class="book-info">
        <h3>{{ reservation.book?.title }}</h3>
        <p class="author">by {{ reservation.book?.author }}</p>
        <app-status-badge [status]="reservation.status"></app-status-badge>
      </div>

      <div class="reservation-details">
        <div class="detail-row">
          <span>Reserved on:</span>
          <span>{{ reservation.createdAt | date : "medium" }}</span>
        </div>
        <div class="detail-row">
          <span>Queue Position:</span>
          <span>#{{ reservation.queuePosition }}</span>
        </div>
        <div class="detail-row" *ngIf="reservation.holdUntil">
          <span>Hold Until:</span>
          <span>{{ reservation.holdUntil | date : "medium" }}</span>
        </div>
      </div>

      <div class="reservation-actions" *ngIf="reservation.status === 'on_hold'">
        <button mat-raised-button color="primary">
          <mat-icon>shopping_bag</mat-icon>
          Confirm Pickup
        </button>
      </div>
    </div>
  </div>
</div>
